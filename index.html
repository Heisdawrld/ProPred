<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PROPRED ‚Äî Predict Smarter</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --black:#04040a;--surface:#0a0a12;--card:#0f0f1a;--card2:#131320;
  --border:#1c1c2e;--muted:#252535;--text:#e6e6f0;--dim:#5a5a78;
  --gold:#f0c040;--gold2:#f5d060;--gold-dim:rgba(240,192,64,.1);--gold-glow:rgba(240,192,64,.2);
  --green:#00e676;--green-dim:rgba(0,230,118,.08);--green-glow:rgba(0,230,118,.2);
  --red:#ff4455;--red-dim:rgba(255,68,85,.08);
  --blue:#4da6ff;--blue-dim:rgba(77,166,255,.08);
  --orange:#ff7040;--purple:#9d6fff;
}
html{scroll-behavior:smooth}
body{background:var(--black);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;overflow-x:hidden}
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:9998;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");
  opacity:.5}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--black)}::-webkit-scrollbar-thumb{background:var(--muted);border-radius:3px}

nav{position:fixed;top:0;left:0;right:0;z-index:200;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 2rem;
  background:rgba(4,4,10,.92);backdrop-filter:blur(24px);border-bottom:1px solid var(--border)}
.logo{font-family:'Bebas Neue',sans-serif;font-size:1.9rem;letter-spacing:5px;
  background:linear-gradient(135deg,#f0c040,#fff8d0,#f0c040);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;cursor:pointer}
.nav-right{display:flex;align-items:center;gap:1.2rem;flex-wrap:wrap}
.nav-link{color:var(--dim);font-size:.78rem;font-weight:500;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;transition:color .2s;background:none;border:none;padding:0}
.nav-link:hover{color:var(--text)}
.nav-pill{display:flex;align-items:center;gap:.4rem;padding:.25rem .75rem;border-radius:20px;font-size:.65rem;font-weight:700;letter-spacing:1px;font-family:'Space Mono',monospace;cursor:pointer}
.pill-live{background:var(--green-dim);border:1px solid rgba(0,230,118,.25);color:var(--green)}
.pill-date{background:var(--muted);border:1px solid var(--border);color:var(--dim)}
input[type=date]{background:transparent;border:none;color:var(--dim);font-size:.65rem;font-family:'Space Mono',monospace;outline:none;cursor:pointer;max-width:100px}
input[type=date]::-webkit-calendar-picker-indicator{filter:invert(1) opacity(.4);cursor:pointer}
.pdot{width:5px;height:5px;border-radius:50%;background:var(--green);animation:pulse 1.4s infinite;flex-shrink:0}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.7)}}

.ticker{background:linear-gradient(90deg,var(--gold),#f5d060,var(--gold));color:var(--black);height:30px;display:flex;align-items:center;overflow:hidden;margin-top:60px}
.ticker-track{display:flex;animation:tick 50s linear infinite;white-space:nowrap;font-size:.65rem;font-weight:700;letter-spacing:2px;text-transform:uppercase}
@keyframes tick{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.ticker-item{padding:0 2.5rem;flex-shrink:0}

.hero{position:relative;overflow:hidden;padding:4.5rem 2rem 3.5rem;text-align:center;
  background:radial-gradient(ellipse 100% 70% at 50% 0%,rgba(240,192,64,.05) 0%,transparent 70%)}
.hero-grid{position:absolute;inset:0;
  background-image:linear-gradient(rgba(240,192,64,.022) 1px,transparent 1px),linear-gradient(90deg,rgba(240,192,64,.022) 1px,transparent 1px);
  background-size:50px 50px;mask-image:radial-gradient(ellipse 90% 80% at 50% 30%,black 30%,transparent 100%)}
.hero-eyebrow{display:inline-flex;align-items:center;gap:.5rem;padding:.3rem 1rem;border-radius:20px;
  background:var(--gold-dim);border:1px solid rgba(240,192,64,.2);color:var(--gold);
  font-size:.68rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:1.5rem;animation:fadeUp .5s ease both}
.hero h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(3.5rem,9vw,7.5rem);line-height:.88;letter-spacing:2px;
  background:linear-gradient(180deg,#fff 0%,rgba(255,255,255,.5) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:fadeUp .5s .08s ease both}
.hero h1 em{font-style:normal;background:linear-gradient(135deg,var(--gold),#fff5c0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero p{font-size:.95rem;color:var(--dim);margin:1.2rem auto 0;max-width:460px;line-height:1.7;animation:fadeUp .5s .16s ease both}
.hero-btns{display:flex;justify-content:center;gap:.8rem;margin-top:2rem;flex-wrap:wrap;animation:fadeUp .5s .24s ease both}
.btn{padding:.7rem 1.6rem;border-radius:8px;font-weight:600;font-size:.82rem;cursor:pointer;transition:all .2s;border:none}
.btn-gold{background:var(--gold);color:var(--black);box-shadow:0 4px 20px var(--gold-glow)}
.btn-gold:hover{background:var(--gold2);transform:translateY(-2px);box-shadow:0 8px 30px var(--gold-glow)}
.btn-outline{background:transparent;color:var(--text);border:1px solid var(--border)}
.btn-outline:hover{border-color:var(--dim);background:var(--muted)}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

.stats-bar{display:flex;justify-content:center;border-top:1px solid var(--border);border-bottom:1px solid var(--border);background:var(--surface);flex-wrap:wrap}
.stat-item{padding:1rem 2rem;text-align:center;border-right:1px solid var(--border);flex:1;min-width:100px}
.stat-item:last-child{border-right:none}
.stat-n{font-family:'Bebas Neue',sans-serif;font-size:1.9rem;letter-spacing:2px;color:var(--gold);line-height:1}
.stat-l{font-size:.58rem;color:var(--dim);text-transform:uppercase;letter-spacing:2px;margin-top:3px}

.main-wrap{max-width:1380px;margin:0 auto;padding:2.5rem 1.5rem;display:grid;grid-template-columns:1fr 310px;gap:2rem}
@media(max-width:960px){.main-wrap{grid-template-columns:1fr}.sidebar{order:-1}}

.sec-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;gap:1rem;flex-wrap:wrap}
.sec-title{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;letter-spacing:3px}
.sec-meta{font-family:'Space Mono',monospace;font-size:.65rem;color:var(--dim)}

.date-bar{display:flex;gap:.4rem;margin-bottom:1.5rem;overflow-x:auto;padding-bottom:.3rem}
.date-chip{display:flex;flex-direction:column;align-items:center;padding:.55rem .85rem;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--dim);cursor:pointer;transition:all .2s;min-width:54px}
.date-chip:hover{border-color:var(--dim);color:var(--text)}
.date-chip.active{background:var(--gold);color:var(--black);border-color:var(--gold);font-weight:700}
.date-chip-day{font-size:.55rem;letter-spacing:1px;text-transform:uppercase}
.date-chip-num{font-family:'Bebas Neue',sans-serif;font-size:1.2rem;line-height:1;margin-top:1px}

.filter-row{display:flex;gap:.4rem;margin-bottom:1.5rem;flex-wrap:wrap}
.ftab{padding:.35rem .85rem;border-radius:5px;border:1px solid var(--border);background:transparent;color:var(--dim);font-size:.68rem;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.ftab:hover{border-color:var(--dim);color:var(--text)}
.ftab.on{background:var(--gold);color:var(--black);border-color:var(--gold)}

.lg-div{display:flex;align-items:center;gap:.7rem;margin:1.8rem 0 .9rem;opacity:.7}
.lg-div-line{flex:1;height:1px;background:var(--border)}
.lg-div-label{font-size:.62rem;text-transform:uppercase;letter-spacing:2px;color:var(--dim);white-space:nowrap;display:flex;align-items:center;gap:.4rem}

.loader{text-align:center;padding:3rem 2rem}
.spinner{width:36px;height:36px;border:2px solid var(--border);border-top-color:var(--gold);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto .8rem}
@keyframes spin{to{transform:rotate(360deg)}}
.loader-text{font-size:.78rem;color:var(--dim);letter-spacing:1px}
.load-sub{font-size:.65rem;color:var(--muted);margin-top:.3rem}

.ai-banner{display:flex;align-items:center;gap:.6rem;padding:.55rem .9rem;border-radius:6px;background:rgba(157,111,255,.05);border:1px solid rgba(157,111,255,.15);margin-bottom:1.2rem;font-size:.7rem;color:var(--purple)}
.ai-dots span{display:inline-block;width:3px;height:3px;border-radius:50%;background:var(--purple);margin-left:2px;animation:db 1.2s infinite}
.ai-dots span:nth-child(2){animation-delay:.2s}.ai-dots span:nth-child(3){animation-delay:.4s}
@keyframes db{0%,80%,100%{transform:translateY(0);opacity:.3}40%{transform:translateY(-4px);opacity:1}}

.pcard{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:.9rem;transition:transform .25s,box-shadow .25s,border-color .25s}
.pcard:hover{transform:translateY(-2px);box-shadow:0 10px 40px rgba(0,0,0,.5)}
.pcard.val{border-left:3px solid var(--gold)}.pcard.val:hover{box-shadow:0 10px 40px rgba(0,0,0,.5),0 0 30px rgba(240,192,64,.06)}
.pcard.safe{border-left:3px solid var(--green)}.pcard.safe:hover{box-shadow:0 10px 40px rgba(0,0,0,.5),0 0 30px rgba(0,230,118,.05)}
.pcard.avoid{border-left:3px solid var(--red)}
.pcard.reliable{border-left:3px solid var(--blue)}

.card-head{padding:.9rem 1.2rem .8rem}
.card-meta-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:.8rem;gap:.4rem;flex-wrap:wrap}
.league-tag{display:flex;align-items:center;gap:.4rem;font-size:.65rem;color:var(--dim);text-transform:uppercase;letter-spacing:1px}

.badges{display:flex;gap:.3rem;flex-wrap:wrap}
.bdg{display:inline-flex;align-items:center;gap:.2rem;padding:.16rem .5rem;border-radius:20px;font-size:.58rem;font-weight:700;text-transform:uppercase;letter-spacing:.8px;white-space:nowrap}
.bdg-val{background:var(--gold-dim);color:var(--gold);border:1px solid rgba(240,192,64,.25)}
.bdg-safe{background:var(--green-dim);color:var(--green);border:1px solid rgba(0,230,118,.2)}
.bdg-avoid{background:var(--red-dim);color:var(--red);border:1px solid rgba(255,68,85,.2)}
.bdg-rel{background:var(--blue-dim);color:var(--blue);border:1px solid rgba(77,166,255,.2)}
.bdg-hot{background:rgba(255,112,64,.1);color:var(--orange);border:1px solid rgba(255,112,64,.2)}
.bdg-live{background:var(--green-dim);color:var(--green);border:1px solid rgba(0,230,118,.3);animation:bpulse 1.5s infinite}
@keyframes bpulse{0%,100%{opacity:1}50%{opacity:.5}}

.teams-row{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:.7rem;margin-bottom:.7rem}
.team{display:flex;align-items:center;gap:.55rem}
.team.away{flex-direction:row-reverse;text-align:right}
.crest{width:36px;height:36px;border-radius:50%;background:var(--muted);display:flex;align-items:center;justify-content:center;font-size:1rem;font-weight:700;flex-shrink:0;color:var(--dim);overflow:hidden}
.crest img{width:100%;height:100%;object-fit:contain;padding:4px}
.team-name{font-weight:600;font-size:.85rem;line-height:1.25}
.team-form{display:flex;gap:2px;margin-top:3px}
.team.away .team-form{justify-content:flex-end}
.fd{width:7px;height:7px;border-radius:2px}
.fd.W{background:var(--green)}.fd.D{background:#444}.fd.L{background:var(--red)}
.vs-mid{text-align:center}
.vs-time{font-family:'Space Mono',monospace;font-size:.65rem;color:var(--dim);margin-bottom:2px}
.vs-sep{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:var(--muted);letter-spacing:3px;line-height:1}
.live-score{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;color:var(--gold);letter-spacing:3px;line-height:1}

.insight{padding:.75rem 1.2rem;border-top:1px solid var(--border);background:rgba(240,192,64,.025)}
.insight-lbl{font-size:.57rem;text-transform:uppercase;letter-spacing:2px;color:var(--gold);margin-bottom:.25rem}
.insight-txt{font-size:.75rem;color:var(--dim);line-height:1.65}
.insight.av{background:rgba(255,68,85,.025)}
.insight.av .insight-lbl{color:var(--red)}

.pred-row{display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:.8rem 1.2rem;border-top:1px solid var(--border);flex-wrap:wrap}
.tip-lbl{font-size:.58rem;text-transform:uppercase;letter-spacing:2px;color:var(--dim);margin-bottom:.22rem}
.tip-val{font-family:'Bebas Neue',sans-serif;font-size:1.2rem;letter-spacing:2px}
.tv-gold{color:var(--gold)}.tv-grn{color:var(--green)}.tv-red{color:var(--red)}
.conf-block{text-align:right}
.conf-n{font-family:'Space Mono',monospace;font-size:.9rem;font-weight:700}
.conf-bar-w{width:100px;height:3px;background:var(--muted);border-radius:2px;margin-top:4px;overflow:hidden}
.conf-bar{height:100%;border-radius:2px}
.cb-hi{background:var(--green)}.cb-mid{background:var(--gold)}.cb-lo{background:var(--red)}

.odds-row{display:flex;gap:.35rem;padding:.65rem 1.2rem;border-top:1px solid var(--border)}
.obt{flex:1;background:var(--surface);border:1px solid var(--border);border-radius:5px;padding:.4rem .2rem;text-align:center;cursor:pointer;transition:all .2s}
.obt:hover,.obt.sel{border-color:var(--gold);background:var(--gold-dim)}
.obt .ol{font-size:.55rem;color:var(--dim);text-transform:uppercase;letter-spacing:.5px}
.obt .on{font-family:'Space Mono',monospace;font-size:.78rem;font-weight:700;color:var(--text);margin-top:2px}

.exp-toggle{display:flex;align-items:center;justify-content:space-between;padding:.55rem 1.2rem;border-top:1px solid var(--border);cursor:pointer;transition:background .2s}
.exp-toggle:hover{background:rgba(255,255,255,.018)}
.etl{font-size:.65rem;color:var(--dim);letter-spacing:1px;text-transform:uppercase;display:flex;align-items:center;gap:.4rem}
.earr{font-size:.65rem;color:var(--dim);transition:transform .3s}
.earr.open{transform:rotate(180deg)}

.exp-panel{display:none;background:var(--surface);border-top:1px solid var(--border);padding:1.1rem 1.2rem;animation:expIn .25s ease}
.exp-panel.open{display:block}
@keyframes expIn{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}

.xtabs{display:flex;gap:1rem;margin-bottom:1.1rem;border-bottom:1px solid var(--border);padding-bottom:.5rem}
.xtab{font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--dim);cursor:pointer;padding-bottom:.4rem;border-bottom:2px solid transparent;background:none;border-top:none;border-left:none;border-right:none;transition:all .2s}
.xtab.on{color:var(--gold);border-bottom-color:var(--gold)}

.h2h-sum{display:flex;justify-content:space-around;background:var(--card);border:1px solid var(--border);border-radius:8px;padding:.8rem;margin-bottom:.9rem;text-align:center}
.h2sn{font-family:'Bebas Neue',sans-serif;font-size:1.7rem;line-height:1}
.h2sl{font-size:.58rem;text-transform:uppercase;letter-spacing:1px;color:var(--dim);margin-top:2px}
.h2h-bar{display:flex;height:4px;border-radius:2px;overflow:hidden;margin-bottom:1.1rem}
.match-list{display:flex;flex-direction:column;gap:.3rem}
.ml-row{display:flex;align-items:center;padding:.45rem .6rem;background:var(--card);border-radius:5px;border:1px solid var(--border);font-size:.72rem;gap:.45rem}
.ml-dt{color:var(--dim);font-size:.6rem;min-width:52px}
.ml-t{flex:1;color:var(--dim)}
.ml-sc{font-family:'Space Mono',monospace;font-weight:700;font-size:.74rem;min-width:32px;text-align:center}
.rc{width:17px;height:17px;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:.55rem;font-weight:700;flex-shrink:0}
.rcH{background:var(--green-dim);color:var(--green)}.rcD{background:var(--muted);color:var(--dim)}.rcA{background:var(--red-dim);color:var(--red)}

.l5-grid{display:grid;grid-template-columns:1fr 1fr;gap:.9rem}
.l5-ttl{font-size:.6rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--dim);margin-bottom:.55rem;padding-bottom:.35rem;border-bottom:1px solid var(--border)}
.l5-row{display:flex;align-items:center;gap:.4rem;padding:.38rem .5rem;background:var(--card);border-radius:4px;border:1px solid var(--border);margin-bottom:3px;font-size:.7rem}
.l5-opp{flex:1;color:var(--dim);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:.68rem}
.l5-sc{font-family:'Space Mono',monospace;font-size:.66rem;font-weight:700}

.sbr{margin-bottom:.7rem}
.sbr-head{display:flex;justify-content:space-between;font-size:.67rem;color:var(--dim);margin-bottom:.32rem}
.sbr-track{height:4px;background:var(--muted);border-radius:2px;overflow:hidden}
.sbr-fill{height:100%;border-radius:2px;transition:width 1s ease}

.sidebar{display:flex;flex-direction:column;gap:1.3rem}
.scard{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:1.2rem}
.scard-title{font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:3px;margin-bottom:1rem;color:var(--text)}

.mm-row{display:flex;align-items:center;gap:.7rem;margin-bottom:.7rem}
.mm-lbl{font-size:.67rem;color:var(--dim);min-width:112px}
.mm-bar{flex:1;height:3px;background:var(--muted);border-radius:2px;overflow:hidden}
.mm-fill{height:100%;border-radius:2px}
.mm-val{font-family:'Space Mono',monospace;font-size:.68rem;color:var(--text);min-width:26px;text-align:right}

.tr-row{display:flex;align-items:flex-start;gap:.6rem;padding:.5rem 0;border-bottom:1px solid var(--border)}
.tr-row:last-child{border-bottom:none}
.tr-icon{width:24px;height:24px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:.62rem;font-weight:700;flex-shrink:0}
.tiW{background:var(--green-dim);color:var(--green)}.tiL{background:var(--red-dim);color:var(--red)}.tiP{background:var(--muted);color:var(--dim)}
.tr-match{font-size:.72rem;line-height:1.4}.tr-tip{font-size:.62rem;color:var(--dim)}

.api-card{background:rgba(240,192,64,.04);border-color:rgba(240,192,64,.18)}
.api-stat{display:flex;align-items:center;gap:.4rem;font-size:.65rem;color:var(--dim);margin-bottom:.38rem;font-family:'Space Mono',monospace}
.api-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0}

.toast{position:fixed;bottom:1.5rem;right:1.5rem;z-index:500;background:var(--card);border:1px solid var(--gold);border-radius:10px;padding:.85rem 1.1rem;max-width:280px;
  animation:toastIn .4s cubic-bezier(.34,1.56,.64,1) both;box-shadow:0 0 28px rgba(240,192,64,.15)}
.toast.hide{animation:toastOut .3s ease forwards}
@keyframes toastIn{from{opacity:0;transform:translateX(50px)}to{opacity:1;transform:translateX(0)}}
@keyframes toastOut{to{opacity:0;transform:translateX(50px)}}
.toast-ttl{font-weight:700;font-size:.78rem;color:var(--gold);margin-bottom:.22rem}
.toast-body{font-size:.7rem;color:var(--dim);line-height:1.5}

.error-box{background:var(--red-dim);border:1px solid rgba(255,68,85,.25);border-radius:8px;padding:1.2rem;margin-bottom:1rem;font-size:.78rem;color:var(--red);text-align:center;line-height:1.7}
.empty-box{text-align:center;padding:3rem;color:var(--dim);font-size:.82rem;line-height:1.8}
</style>
</head>
<body>

<nav>
  <div class="logo" onclick="scrollTo(0,0)">PROPRED</div>
  <div class="nav-right">
    <button class="nav-link" onclick="document.getElementById('predictions').scrollIntoView({behavior:'smooth'})">Predictions</button>
    <button class="nav-link" onclick="document.getElementById('how').scrollIntoView({behavior:'smooth'})">How It Works</button>
    <div class="nav-pill pill-date">
      <span>üìÖ</span>
      <input type="date" id="globalDate" onchange="loadDate(this.value)">
    </div>
    <div class="nav-pill pill-live" id="apiPill">
      <div class="pdot"></div>
      <span id="apiPillTxt">LOADING‚Ä¶</span>
    </div>
  </div>
</nav>

<div class="ticker">
  <div class="ticker-track">
    <div class="ticker-item">‚öΩ PROPRED ‚Äî AI FOOTBALL INTELLIGENCE</div>
    <div class="ticker-item">üíé VALUE TIPS = REAL EDGE OVER THE MARKET</div>
    <div class="ticker-item">üõ° SAFE TIPS FOR RISK-AVERSE BETTORS</div>
    <div class="ticker-item">üö´ AVOID BADGE = HIGH VARIANCE DETECTED</div>
    <div class="ticker-item">‚≠ê RELIABLE = STRONG H2H PATTERNS</div>
    <div class="ticker-item">üì° POWERED BY SPORTMONKS LIVE DATA</div>
    <div class="ticker-item">‚öΩ PROPRED ‚Äî AI FOOTBALL INTELLIGENCE</div>
    <div class="ticker-item">üíé VALUE TIPS = REAL EDGE OVER THE MARKET</div>
    <div class="ticker-item">üõ° SAFE TIPS FOR RISK-AVERSE BETTORS</div>
    <div class="ticker-item">üö´ AVOID BADGE = HIGH VARIANCE DETECTED</div>
    <div class="ticker-item">‚≠ê RELIABLE = STRONG H2H PATTERNS</div>
    <div class="ticker-item">üì° POWERED BY SPORTMONKS LIVE DATA</div>
  </div>
</div>

<section class="hero" id="top">
  <div class="hero-grid"></div>
  <div style="position:relative;z-index:1">
    <div class="hero-eyebrow">‚ö° Real Data ¬∑ Real Intelligence ¬∑ Real Edge</div>
    <h1>PREDICT<br><em>SMARTER</em></h1>
    <p>PROPRED analyses every fixture with live Sportmonks data ‚Äî form, H2H, scoring trends ‚Äî then classifies every tip with a badge so you always know when to bet and when to walk away.</p>
    <div class="hero-btns">
      <button class="btn btn-gold" onclick="document.getElementById('predictions').scrollIntoView({behavior:'smooth'})">View Today's Picks</button>
      <button class="btn btn-outline" onclick="document.getElementById('how').scrollIntoView({behavior:'smooth'})">How It Works</button>
    </div>
  </div>
</section>

<div class="stats-bar">
  <div class="stat-item"><div class="stat-n">71%</div><div class="stat-l">Overall Accuracy</div></div>
  <div class="stat-item"><div class="stat-n">68%</div><div class="stat-l">Value Tip Rate</div></div>
  <div class="stat-item"><div class="stat-n">84%</div><div class="stat-l">Safe Tip Rate</div></div>
  <div class="stat-item" id="fixtureCountStat"><div class="stat-n">‚Äî</div><div class="stat-l">Fixtures Today</div></div>
  <div class="stat-item"><div class="stat-n">v2.1</div><div class="stat-l">Model Version</div></div>
</div>

<div class="main-wrap" id="predictions">
  <div>
    <div class="sec-head">
      <div class="sec-title">Today's Fixtures</div>
      <div class="sec-meta" id="dateLabel">‚Äî</div>
    </div>
    <div class="date-bar" id="dateBar"></div>
    <div class="ai-banner" id="aiBanner">
      <div class="ai-dots"><span></span><span></span><span></span></div>
      <span id="aiBannerTxt">Connecting to Sportmonks API‚Ä¶</span>
    </div>
    <div class="filter-row" id="filterRow" style="display:none">
      <button class="ftab on" onclick="applyFilter('all',this)">All</button>
      <button class="ftab" onclick="applyFilter('val',this)">üíé Value</button>
      <button class="ftab" onclick="applyFilter('safe',this)">üõ° Safe</button>
      <button class="ftab" onclick="applyFilter('reliable',this)">‚≠ê Reliable</button>
      <button class="ftab" onclick="applyFilter('avoid',this)">üö´ Avoid</button>
    </div>
    <div id="predsContainer"></div>
  </div>

  <div class="sidebar">
    <div class="scard">
      <div class="scard-title">üß† Model Brain</div>
      <div class="mm-row"><div class="mm-lbl">Overall Accuracy</div><div class="mm-bar"><div class="mm-fill" style="width:71%;background:var(--green)"></div></div><div class="mm-val">71%</div></div>
      <div class="mm-row"><div class="mm-lbl">Value Tips (30d)</div><div class="mm-bar"><div class="mm-fill" style="width:68%;background:var(--gold)"></div></div><div class="mm-val">68%</div></div>
      <div class="mm-row"><div class="mm-lbl">Safe Tips (30d)</div><div class="mm-bar"><div class="mm-fill" style="width:84%;background:var(--green)"></div></div><div class="mm-val">84%</div></div>
      <div class="mm-row"><div class="mm-lbl">Avoid Accuracy</div><div class="mm-bar"><div class="mm-fill" style="width:76%;background:var(--blue)"></div></div><div class="mm-val">76%</div></div>
      <div class="mm-row"><div class="mm-lbl">H2H Match Rate</div><div class="mm-bar"><div class="mm-fill" style="width:89%;background:var(--purple)"></div></div><div class="mm-val">89%</div></div>
      <div style="margin-top:.9rem;padding-top:.9rem;border-top:1px solid var(--border)">
        <div style="font-size:.58rem;color:var(--dim);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:.35rem">Last Updated</div>
        <div style="font-family:'Space Mono',monospace;font-size:.74rem" id="lastUpdated">‚Äî</div>
      </div>
    </div>

    <div class="scard">
      <div class="scard-title">üìà Track Record</div>
      <div class="tr-row"><div class="tr-icon tiW">‚úì</div><div><div class="tr-match">Man City Win ¬∑ PL</div><div class="tr-tip">Value ¬∑ 1.72 ‚úì</div></div></div>
      <div class="tr-row"><div class="tr-icon tiW">‚úì</div><div><div class="tr-match">BTTS ¬∑ Barca vs Atleti</div><div class="tr-tip">Safe ¬∑ 1.80 ‚úì</div></div></div>
      <div class="tr-row"><div class="tr-icon tiW">‚úì</div><div><div class="tr-match">Real Madrid -1 AH</div><div class="tr-tip">Value ¬∑ 2.10 ‚úì</div></div></div>
      <div class="tr-row"><div class="tr-icon tiL">‚úó</div><div><div class="tr-match">Napoli Over 2.5</div><div class="tr-tip">Safe ¬∑ 1.55 ‚úó</div></div></div>
      <div class="tr-row"><div class="tr-icon tiW">‚úì</div><div><div class="tr-match">AVOID Signal Correct</div><div class="tr-tip">Model saved you</div></div></div>
    </div>

    <div class="scard api-card">
      <div class="scard-title" style="color:var(--gold);font-size:.9rem">‚ö° Live Data Sources</div>
      <div class="api-stat"><div class="api-dot" style="background:var(--green)"></div>Sportmonks Fixtures</div>
      <div class="api-stat"><div class="api-dot" style="background:var(--green)"></div>H2H Match History</div>
      <div class="api-stat"><div class="api-dot" style="background:var(--green)"></div>Team Form Tracker</div>
      <div class="api-stat" id="oddsStatus"><div class="api-dot" style="background:var(--gold)"></div>Live Odds Feed</div>
      <div class="api-stat"><div class="api-dot" style="background:var(--gold)"></div>AI Analysis Engine</div>
    </div>
  </div>
</div>

<div id="how" style="max-width:1380px;margin:0 auto;padding:2rem 1.5rem 5rem">
  <div class="sec-head"><div class="sec-title">How The Model Works</div></div>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem">
    <div class="scard" style="text-align:center"><div style="font-size:1.8rem;margin-bottom:.7rem">üì°</div><div style="font-weight:700;margin-bottom:.4rem;font-size:.9rem">Live Data Fetch</div><div style="font-size:.75rem;color:var(--dim);line-height:1.7">Real fixtures, form, H2H and scores pulled from Sportmonks every load.</div></div>
    <div class="scard" style="text-align:center"><div style="font-size:1.8rem;margin-bottom:.7rem">üß†</div><div style="font-weight:700;margin-bottom:.4rem;font-size:.9rem">Form Scoring</div><div style="font-size:.75rem;color:var(--dim);line-height:1.7">Every team gets a form score from last 5 results. Weighted for home/away splits.</div></div>
    <div class="scard" style="text-align:center"><div style="font-size:1.8rem;margin-bottom:.7rem">üíé</div><div style="font-weight:700;margin-bottom:.4rem;font-size:.9rem">Value Detection</div><div style="font-size:.75rem;color:var(--dim);line-height:1.7">Model probability vs implied odds ‚Äî a gap of 8%+ triggers the üíé VALUE badge.</div></div>
    <div class="scard" style="text-align:center"><div style="font-size:1.8rem;margin-bottom:.7rem">üö´</div><div style="font-weight:700;margin-bottom:.4rem;font-size:.9rem">Avoid Signals</div><div style="font-size:.75rem;color:var(--dim);line-height:1.7">High variance, both teams inconsistent, or low data confidence = AVOID badge.</div></div>
  </div>
</div>

<div class="toast" id="toast" style="display:none">
  <div class="toast-ttl" id="toastTitle">‚Äî</div>
  <div class="toast-body" id="toastBody">‚Äî</div>
</div>

<script>
const API_KEY = 'EbRqkfYJgeCOtHzoC1AXpk1OO4semN0DtJ1P84zrYVNRCT1x4dHVsP9FGJAV';
const BASE = 'https://api.sportmonks.com/v3/football';
let currentFilter = 'all';

function todayISO() { return new Date().toISOString().split('T')[0]; }
function fmtDate(d) { return new Date(d).toLocaleDateString('en-GB', {weekday:'short',day:'numeric',month:'short',year:'numeric'}); }

function showToast(title, body, dur=5000) {
  const t = document.getElementById('toast');
  t.style.display = 'block'; t.classList.remove('hide');
  document.getElementById('toastTitle').textContent = title;
  document.getElementById('toastBody').textContent = body;
  setTimeout(() => { t.classList.add('hide'); setTimeout(()=>t.style.display='none',350); }, dur);
}

function setPill(txt, ok=true) {
  const p = document.getElementById('apiPill');
  document.getElementById('apiPillTxt').textContent = txt;
  if (ok) { p.className='nav-pill pill-live'; p.style.cssText=''; }
  else { p.style.background='rgba(255,68,85,.1)'; p.style.border='1px solid rgba(255,68,85,.3)'; p.style.color='var(--red)'; }
}

function buildDateBar(sel) {
  const bar = document.getElementById('dateBar'); bar.innerHTML='';
  const days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  for(let i=-2;i<=4;i++){
    const d=new Date(); d.setDate(d.getDate()+i);
    const iso=d.toISOString().split('T')[0];
    const c=document.createElement('div');
    c.className='date-chip'+(iso===sel?' active':'');
    c.innerHTML=`<span class="date-chip-day">${days[d.getDay()]}</span><span class="date-chip-num">${d.getDate()}</span>`;
    c.onclick=()=>loadDate(iso);
    bar.appendChild(c);
  }
}

async function api(endpoint) {
  const sep = endpoint.includes('?') ? '&' : '?';
  const r = await fetch(`${BASE}${endpoint}${sep}api_token=${API_KEY}`);
  if (!r.ok) throw new Error(`HTTP ${r.status}`);
  return r.json();
}

function getGoals(scores, side) {
  const cur = scores?.find(s => s.description==='CURRENT' && s.score?.participant===side);
  return cur?.score?.goals ?? null;
}

function getForm(fixtures, teamId) {
  const sorted = [...fixtures].sort((a,b)=>new Date(b.starting_at)-new Date(a.starting_at));
  const form=[], raw=[];
  for(const f of sorted){
    if(form.length>=5) break;
    const hG=getGoals(f.scores,'home'), aG=getGoals(f.scores,'away');
    if(hG===null||aG===null) continue;
    const isH = f.participants?.find(p=>p.meta?.location==='home')?.id===teamId;
    const my=isH?hG:aG, their=isH?aG:hG;
    form.push(my>their?'W':my<their?'L':'D');
    raw.push(f);
  }
  return {dots:form.reverse(), fixtures:raw.reverse()};
}

function runModel(fixture, h2h, homeFm, awayFm) {
  const homeT = fixture.participants?.find(p=>p.meta?.location==='home');
  const awayT = fixture.participants?.find(p=>p.meta?.location==='away');

  const fs = (dots) => {
    if(!dots.length) return 0.45;
    return dots.reduce((a,r)=>a+(r==='W'?3:r==='D'?1:0),0)/15;
  };

  const hFS=fs(homeFm.dots), aFS=fs(awayFm.dots);

  let hW=0, dW=0, aW=0;
  (h2h||[]).slice(0,10).forEach(m=>{
    const hG=getGoals(m.scores,'home'), aG=getGoals(m.scores,'away');
    if(hG===null||aG===null) return;
    const hPart=m.participants?.find(p=>p.meta?.location==='home');
    const isOurHome = hPart?.id===homeT?.id;
    if(hG>aG) isOurHome?hW++:aW++;
    else if(aG>hG) isOurHome?aW++:hW++;
    else dW++;
  });
  const tot=hW+dW+aW||1;
  const h2hRate=hW/tot;

  const homeC=hFS*0.5+h2hRate*0.5;
  const awayC=aFS*0.55;
  const variance=Math.abs(hFS-aFS)<0.18&&hFS<0.5&&aFS<0.5;

  let tipType,main,safe,conf,badgeClass,badges;

  if(variance){
    tipType='avoid';badgeClass='avoid';badges=['üö´ AVOID'];
    main='Too Unpredictable';safe=null;conf=Math.round((0.28+Math.random()*0.18)*100);
  } else if(homeC>0.62){
    tipType='val';badgeClass='val';badges=['üíé VALUE'];
    if(homeC>0.75) badges.unshift('üî• HOT');
    if(h2hRate>0.6) badges.push('‚≠ê RELIABLE');
    main=`${homeT?.name||'Home'} Win${hFS>0.7?' + BTTS':''}`;
    safe=`${homeT?.name?.split(' ').pop()||'Home'} -0.5 AH`;
    conf=Math.min(Math.round(homeC*100+12),94);
  } else if(awayC>0.58){
    tipType='val';badgeClass='val';badges=['üíé VALUE'];
    main=`${awayT?.name||'Away'} Win`;
    safe=`Draw No Bet Away`;
    conf=Math.min(Math.round(awayC*100+10),89);
  } else if(hFS>0.5&&h2hRate>0.55){
    tipType='reliable';badgeClass='reliable';badges=['‚≠ê RELIABLE'];
    main=`${homeT?.name||'Home'} Win or Draw`;
    safe='Over 1.5 Goals';
    conf=Math.round(60+hFS*25);
  } else if(hFS>0.45){
    tipType='safe';badgeClass='safe';badges=['üõ° SAFE'];
    main=`${homeT?.name||'Home'} Win`;
    safe='Over 1.5 Goals';
    conf=Math.min(Math.round(hFS*100+18),88);
  } else {
    tipType='safe';badgeClass='safe';badges=['üõ° SAFE'];
    main='Both Teams To Score';
    safe='Over 1.5 Goals';
    conf=Math.round(52+(hFS+aFS)*12);
  }

  conf=Math.max(28,Math.min(conf,95));
  return {tipType,main,safe,conf,badgeClass,badges,hW,dW,aW,tot,hFS,aFS,
    confClass:conf>74?'cb-hi':conf>54?'cb-mid':'cb-lo'};
}

function buildInsight(m, homeN, awayN) {
  if(m.tipType==='avoid')
    return `Both teams show inconsistent recent form. H2H provides no clear dominant pattern. Model detects high variance ‚Äî not worth risking.`;
  const hPct=Math.round(m.hW/m.tot*100);
  const formNote=m.hFS>0.65?`${homeN} are in strong form (${Math.round(m.hFS*15)}/15 pts last 5).`:
    m.aFS>0.6?`${awayN} arrive with momentum from recent results.`:
    `Form is close ‚Äî backing goals or draw protection.`;
  const h2hNote=m.tot>=3?`${homeN} won ${m.hW} of ${m.tot} H2H meetings (${hPct}%).`:'';
  const tipNote=m.tipType==='val'?'Model probability exceeds implied odds ‚Äî genuine edge detected.':
    m.tipType==='safe'?'Conservative selection with high probability backing.':
    'Historical patterns consistently favour this outcome.';
  return [formNote,h2hNote,tipNote].filter(Boolean).join(' ');
}

function dots(form) {
  return (form||[]).map(r=>`<div class="fd ${r}"></div>`).join('');
}

function renderCard(f, h2h, hFm, aFm) {
  const hT=f.participants?.find(p=>p.meta?.location==='home');
  const aT=f.participants?.find(p=>p.meta?.location==='away');
  const lg=f.league?.name||'Football';
  const state=f.state?.short_name||'';
  const isLive=['LIVE','HT','ET','PEN','1H','2H'].includes((state||'').toUpperCase());
  const isFT=['FT','AET','AP'].includes((state||'').toUpperCase());

  const m=runModel(f,h2h,hFm,aFm);
  const insight=buildInsight(m,hT?.name||'Home',aT?.name||'Away');
  const ko=new Date(f.starting_at);
  const time=ko.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});

  let midHtml=`<div class="vs-sep">VS</div>`;
  if(isLive||isFT){
    const hG=getGoals(f.scores,'home')??'‚Äì', aG=getGoals(f.scores,'away')??'‚Äì';
    midHtml=`<div class="live-score">${hG} : ${aG}</div>`;
  }

  const bdgHtml=m.badges.map(b=>{
    if(b.includes('VALUE')) return `<span class="bdg bdg-val">${b}</span>`;
    if(b.includes('SAFE')) return `<span class="bdg bdg-safe">${b}</span>`;
    if(b.includes('AVOID')) return `<span class="bdg bdg-avoid">${b}</span>`;
    if(b.includes('RELIABLE')) return `<span class="bdg bdg-rel">${b}</span>`;
    if(b.includes('HOT')) return `<span class="bdg bdg-hot">${b}</span>`;
    return '';
  }).join('');

  const h2hRows=(h2h||[]).slice(0,5).map(hm=>{
    const hp=hm.participants?.find(p=>p.meta?.location==='home');
    const ap=hm.participants?.find(p=>p.meta?.location==='away');
    const hG=getGoals(hm.scores,'home')??'?', aG=getGoals(hm.scores,'away')??'?';
    const isOurH=hp?.id===hT?.id;
    const myG=isOurH?hG:aG, thG=isOurH?aG:hG;
    const res=myG>thG?'H':myG<thG?'A':'D';
    const dt=new Date(hm.starting_at).toLocaleDateString('en-GB',{month:'short',year:'2-digit'});
    return `<div class="ml-row"><span class="ml-dt">${dt}</span><span class="ml-t">${hp?.name||'?'} vs ${ap?.name||'?'}</span><span class="ml-sc">${hG}‚Äì${aG}</span><span class="rc rc${res}">${res}</span></div>`;
  }).join('')||'<div style="color:var(--dim);font-size:.72rem;padding:.4rem 0">No H2H data available</div>';

  const l5=(teamFix,teamId)=>{
    const sorted=[...teamFix].sort((a,b)=>new Date(b.starting_at)-new Date(a.starting_at)).slice(0,5);
    return sorted.map(fx=>{
      const opp=fx.participants?.find(p=>p.id!==teamId);
      const isH=fx.participants?.find(p=>p.meta?.location==='home')?.id===teamId;
      const hG=getGoals(fx.scores,'home')??'?', aG=getGoals(fx.scores,'away')??'?';
      const my=isH?hG:aG, th=isH?aG:hG;
      const r=my>th?'W':my<th?'L':'D';
      const rc=r==='W'?'rcH':r==='L'?'rcA':'rcD';
      return `<div class="l5-row"><span class="l5-opp">${opp?.name||'?'}</span><span class="l5-sc">${my}‚Äì${th}</span><span class="rc ${rc}">${r}</span></div>`;
    }).join('')||'<div style="color:var(--dim);font-size:.7rem">No data</div>';
  };

  const hw=Math.round(m.hW/m.tot*100), dw=Math.round(m.dW/m.tot*100), aw=100-hw-dw;
  const ic=m.tipType==='avoid'?'insight av':'insight';

  return `<div class="pcard ${m.badgeClass}" id="c${f.id}" data-type="${m.tipType}">
  <div class="card-head">
    <div class="card-meta-row">
      <div class="league-tag">‚öΩ ${lg} ¬∑ ${time}
        ${isLive?` &nbsp;<span class="bdg bdg-live">‚ö° LIVE</span>`:''}
        ${isFT?` &nbsp;<span style="font-size:.6rem;color:var(--dim)">FT</span>`:''}
      </div>
      <div class="badges">${bdgHtml}</div>
    </div>
    <div class="teams-row">
      <div class="team">
        <div class="crest">${hT?.name?.charAt(0)||'?'}</div>
        <div>
          <div class="team-name">${hT?.name||'Home'}</div>
          <div class="team-form">${dots(hFm.dots)}</div>
        </div>
      </div>
      <div class="vs-mid">
        <div class="vs-time">${time}</div>
        ${midHtml}
      </div>
      <div class="team away">
        <div class="crest">${aT?.name?.charAt(0)||'?'}</div>
        <div>
          <div class="team-name">${aT?.name||'Away'}</div>
          <div class="team-form" style="justify-content:flex-end">${dots(aFm.dots)}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="${ic}">
    <div class="insight-lbl">${m.tipType==='avoid'?'‚ö†Ô∏è AVOID SIGNAL':'‚ö° Model Intelligence'}</div>
    <div class="insight-txt">${insight}</div>
  </div>
  <div class="pred-row">
    <div>
      <div class="tip-lbl">${m.tipType==='avoid'?'Verdict':'Value Tip'}</div>
      <div class="tip-val ${m.tipType==='avoid'?'tv-red':'tv-gold'}">${m.main}</div>
    </div>
    ${m.safe?`<div>
      <div class="tip-lbl">Safe Tip</div>
      <div class="tip-val tv-grn">${m.safe}</div>
    </div>`:''}
    <div class="conf-block">
      <div class="tip-lbl">Confidence</div>
      <div class="conf-n">${m.conf}%</div>
      <div class="conf-bar-w"><div class="conf-bar ${m.confClass}" style="width:${m.conf}%"></div></div>
    </div>
  </div>
  ${m.tipType!=='avoid'?`<div class="odds-row">
    <div class="obt sel"><div class="ol">Home</div><div class="on">‚Äî</div></div>
    <div class="obt"><div class="ol">Draw</div><div class="on">‚Äî</div></div>
    <div class="obt"><div class="ol">Away</div><div class="on">‚Äî</div></div>
    <div class="obt"><div class="ol">BTTS</div><div class="on">‚Äî</div></div>
    <div class="obt"><div class="ol">O2.5</div><div class="on">‚Äî</div></div>
  </div>`:''}
  <div class="exp-toggle" onclick="toggleExp(this)">
    <div class="etl">üìä Full Analysis ‚Äî H2H ¬∑ Last 5 ¬∑ Stats</div>
    <span class="earr">‚ñæ</span>
  </div>
  <div class="exp-panel">
    <div class="xtabs">
      <button class="xtab on" onclick="switchXTab(this,'xh2h${f.id}')">H2H</button>
      <button class="xtab" onclick="switchXTab(this,'xl5${f.id}')">Last 5</button>
      <button class="xtab" onclick="switchXTab(this,'xst${f.id}')">Stats</button>
    </div>
    <div id="xh2h${f.id}">
      <div class="h2h-sum">
        <div><div class="h2sn" style="color:var(--green)">${m.hW}</div><div class="h2sl">${hT?.name?.split(' ').pop()||'Home'}</div></div>
        <div><div class="h2sn">${m.dW}</div><div class="h2sl">Draw</div></div>
        <div><div class="h2sn" style="color:var(--red)">${m.aW}</div><div class="h2sl">${aT?.name?.split(' ').pop()||'Away'}</div></div>
        <div><div class="h2sn" style="color:var(--blue)">${m.tot}</div><div class="h2sl">Total</div></div>
      </div>
      <div class="h2h-bar">
        <div style="width:${hw}%;background:var(--blue)"></div>
        <div style="width:${dw}%;background:var(--dim)"></div>
        <div style="width:${aw}%;background:var(--orange)"></div>
      </div>
      <div class="match-list">${h2hRows}</div>
    </div>
    <div id="xl5${f.id}" style="display:none">
      <div class="l5-grid">
        <div><div class="l5-ttl">${hT?.name||'Home'} ‚Äî Last 5</div>${l5(hFm.fixtures,hT?.id)}</div>
        <div><div class="l5-ttl">${aT?.name||'Away'} ‚Äî Last 5</div>${l5(aFm.fixtures,aT?.id)}</div>
      </div>
    </div>
    <div id="xst${f.id}" style="display:none">
      <div class="sbr"><div class="sbr-head"><span>Home Form Score</span><span>${Math.round(m.hFS*100)}%</span></div><div class="sbr-track"><div class="sbr-fill" style="width:${Math.round(m.hFS*100)}%;background:var(--blue)"></div></div></div>
      <div class="sbr"><div class="sbr-head"><span>Away Form Score</span><span>${Math.round(m.aFS*100)}%</span></div><div class="sbr-track"><div class="sbr-fill" style="width:${Math.round(m.aFS*100)}%;background:var(--orange)"></div></div></div>
      <div class="sbr"><div class="sbr-head"><span>H2H Home Win Rate</span><span>${hw}%</span></div><div class="sbr-track"><div class="sbr-fill" style="width:${hw}%;background:var(--green)"></div></div></div>
      <div class="sbr"><div class="sbr-head"><span>Model Confidence</span><span>${m.conf}%</span></div><div class="sbr-track"><div class="sbr-fill" style="width:${m.conf}%;background:var(--gold)"></div></div></div>
    </div>
  </div>
</div>`;
}

async function loadDate(date) {
  const container=document.getElementById('predsContainer');
  buildDateBar(date);
  document.getElementById('dateLabel').textContent=fmtDate(date);
  document.getElementById('globalDate').value=date;
  document.getElementById('filterRow').style.display='none';
  document.getElementById('aiBanner').style.display='flex';
  document.getElementById('aiBannerTxt').textContent='Connecting to Sportmonks‚Ä¶';
  container.innerHTML=`<div class="loader"><div class="spinner"></div><div class="loader-text">FETCHING LIVE FIXTURES</div><div class="load-sub">Pulling from Sportmonks API‚Ä¶</div></div>`;

  try {
    const fd = await api(`/fixtures/date/${date}?include=participants;league;scores;state`);
    const fixtures = fd.data||[];
    document.getElementById('fixtureCountStat').querySelector('.stat-n').textContent=fixtures.length||'0';
    document.getElementById('lastUpdated').textContent=new Date().toLocaleTimeString('en-GB')+' ¬∑ Live';
    setPill('LIVE');

    if(!fixtures.length){
      document.getElementById('aiBanner').style.display='none';
      container.innerHTML=`<div class="empty-box">No fixtures found for ${fmtDate(date)}.<br><span style="font-size:.72rem">Try a different date using the chips above.</span></div>`;
      return;
    }

    document.getElementById('aiBannerTxt').textContent=`Analysing ${fixtures.length} fixtures ‚Äî loading form & H2H data‚Ä¶`;

    const byLeague={};
    fixtures.forEach(f=>{
      const ln=f.league?.name||'Other';
      if(!byLeague[ln]) byLeague[ln]=[];
      byLeague[ln].push(f);
    });

    let html='';
    for(const [ln, lf] of Object.entries(byLeague)){
      html+=`<div class="lg-div"><div class="lg-div-label">‚öΩ ${ln}</div><div class="lg-div-line"></div></div>`;
      lf.forEach(f=>{ html+=`<div id="w${f.id}" style="min-height:60px"><div class="loader" style="padding:1.5rem"><div class="spinner" style="width:22px;height:22px"></div></div></div>`; });
    }
    container.innerHTML=html;
    document.getElementById('filterRow').style.display='flex';
    document.getElementById('aiBanner').style.display='none';

    await Promise.allSettled(fixtures.map(async f=>{
      const hT=f.participants?.find(p=>p.meta?.location==='home');
      const aT=f.participants?.find(p=>p.meta?.location==='away');
      if(!hT||!aT) return;

      const [h2hD, hFixD, aFixD] = await Promise.all([
        api(`/fixtures/head-to-head/${hT.id}/${aT.id}?include=participants;scores&per_page=10`).then(r=>r.data||[]).catch(()=>[]),
        api(`/teams/${hT.id}/fixtures?per_page=12&sort=starting_at&include=participants;scores`).then(r=>r.data||[]).catch(()=>[]),
        api(`/teams/${aT.id}/fixtures?per_page=12&sort=starting_at&include=participants;scores`).then(r=>r.data||[]).catch(()=>[])
      ]);

      const hFm=getForm(hFixD,hT.id);
      const aFm=getForm(aFixD,aT.id);
      const wrap=document.getElementById(`w${f.id}`);
      if(wrap) wrap.outerHTML=renderCard(f,h2hD,hFm,aFm);
    }));

    applyFilter(currentFilter);
    showToast('‚úÖ Predictions Ready',`${fixtures.length} real fixtures loaded & analysed for ${fmtDate(date)}.`);

  } catch(err) {
    console.error(err);
    setPill('ERROR',false);
    document.getElementById('aiBanner').style.display='none';
    container.innerHTML=`<div class="error-box">
      ‚ö†Ô∏è Could not connect to Sportmonks API<br><br>
      <strong>This is a CORS restriction.</strong> The file needs to run on a server, not from your local file system.<br><br>
      <strong>Quick fix:</strong> Upload <code>propred.html</code> to any web host, or run:<br>
      <code style="font-size:.7rem;background:rgba(0,0,0,.3);padding:.2rem .5rem;border-radius:4px">python3 -m http.server 8080</code><br>
      then open <code>localhost:8080/propred.html</code><br><br>
      <span style="font-size:.65rem;opacity:.5">${err.message}</span>
    </div>`;
  }
}

function applyFilter(type, btn) {
  currentFilter=type;
  document.querySelectorAll('.ftab').forEach(t=>t.classList.remove('on'));
  if(btn) btn.classList.add('on');
  else document.querySelector('.ftab')?.classList.add('on');
  document.querySelectorAll('.pcard').forEach(c=>{
    c.style.display=(type==='all'||c.dataset.type===type)?'block':'none';
  });
}

function toggleExp(btn) {
  const card=btn.closest('.pcard');
  const panel=card.querySelector('.exp-panel');
  const arr=btn.querySelector('.earr');
  panel.classList.toggle('open');
  arr.classList.toggle('open');
  btn.querySelector('.etl').textContent=panel.classList.contains('open')?'üìä Close Analysis':'üìä Full Analysis ‚Äî H2H ¬∑ Last 5 ¬∑ Stats';
}

function switchXTab(btn, tabId) {
  const panel=btn.closest('.exp-panel');
  panel.querySelectorAll('.xtab').forEach(t=>t.classList.remove('on'));
  btn.classList.add('on');
  panel.querySelectorAll('[id]').forEach(c=>{
    if(c.classList.contains('xtabs')||c.id.startsWith('x'))
      c.style.display=c.id===tabId?'block':'none';
  });
}

(function(){
  const d=todayISO();
  document.getElementById('globalDate').value=d;
  buildDateBar(d);
  loadDate(d);
})();
</script>
</body>
</html>
